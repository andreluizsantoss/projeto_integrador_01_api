<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro - SOS Sorocaba</title>
    <link rel="stylesheet" href="../V3/src/styles/forms.css">
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState } = React;

        // Register Component
        function Register() {
            const [formData, setFormData] = useState({});
            const [isSubmitting, setIsSubmitting] = useState(false);

            const handleChange = (e) => {
                const { name, value, type, checked } = e.target;
                setFormData(prev => ({
                    ...prev,
                    [name]: type === 'checkbox' ? checked : value
                }));
            };

            const generateUserCode = (nome) => {
                if (!nome) return '';
                const cleanName = nome.trim().toUpperCase().replace(/[^A-Z\s]/g, '');
                const words = cleanName.split(' ').filter(word => word.length > 0);
                if (words.length === 0) return '';
                const initials = words.map(word => word[0]).join('');
                const timestamp = Date.now().toString().slice(-4);
                return `${initials}${timestamp}`;
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                if (isSubmitting) return;

                setIsSubmitting(true);
                try {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                    alert('Cadastro realizado com sucesso!');
                    setFormData({});
                } catch (error) {
                    alert('Erro ao cadastrar usuário. Tente novamente.');
                } finally {
                    setIsSubmitting(false);
                }
            };

            return (
                <>
                    <section>
                        <h1>Cadastro de novos Usuários</h1>
                        <p style={{ color: '#666', marginBottom: '1rem' }}>
                            Preencha os dados do novo paciente no sistema
                        </p>
                    </section>
                    
                    <section>
                        <form onSubmit={handleSubmit}>
                            <div className="form-grid">
                                <div className="form-col">
                                    <label htmlFor="nome">Nome:</label>
                                    <input 
                                        type="text" 
                                        id="nome" 
                                        name="nome" 
                                        placeholder="Nome completo" 
                                        required 
                                        value={formData.nome || ''}
                                        onChange={handleChange}
                                    />

                                    <label htmlFor="idade">Idade:</label>
                                    <input 
                                        type="number" 
                                        id="idade" 
                                        name="idade" 
                                        min="0" 
                                        max="120"
                                        required 
                                        value={formData.idade || ''}
                                        onChange={handleChange}
                                    />

                                    <label htmlFor="documento">Documento:</label>
                                    <input 
                                        type="text" 
                                        id="documento" 
                                        name="documento" 
                                        placeholder="000.000.000-00"
                                        maxLength="20" 
                                        required 
                                        value={formData.documento || ''}
                                        onChange={handleChange}
                                    />

                                    <label htmlFor="data_nascimento">Data de Nascimento:</label>
                                    <input 
                                        type="date" 
                                        id="data_nascimento" 
                                        name="data_nascimento" 
                                        required 
                                        value={formData.data_nascimento || ''}
                                        onChange={handleChange}
                                    />

                                    <label htmlFor="sexo">Sexo:</label>
                                    <select id="sexo" name="sexo" required value={formData.sexo || ''} onChange={handleChange}>
                                        <option value="">Selecione</option>
                                        <option value="Masculino">Masculino</option>
                                        <option value="Feminino">Feminino</option>
                                        <option value="Outro">Outro</option>
                                    </select>

                                    <label htmlFor="profissao">Profissão:</label>
                                    <input 
                                        type="text" 
                                        id="profissao" 
                                        name="profissao" 
                                        placeholder="Profissão atual"
                                        value={formData.profissao || ''}
                                        onChange={handleChange}
                                    />
                                </div>

                                <div className="form-col">
                                    <label htmlFor="status">Status:</label>
                                    <select id="status" name="status" required value={formData.status || ''} onChange={handleChange}>
                                        <option value="">Selecione</option>
                                        <option value="Ativo">Ativo</option>
                                        <option value="Bloqueado">Bloqueado</option>
                                    </select>

                                    <label htmlFor="tipo_documento">Tipo de Documento:</label>
                                    <select id="tipo_documento" name="tipo_documento" required value={formData.tipo_documento || ''} onChange={handleChange}>
                                        <option value="">Selecione</option>
                                        <option value="RG">RG</option>
                                        <option value="CPF">CPF</option>
                                    </select>

                                    <label htmlFor="codigo_usuario">Código do Usuário:</label>
                                    <input 
                                        type="text" 
                                        id="codigo_usuario" 
                                        name="codigo_usuario" 
                                        value={formData.codigo_usuario || generateUserCode(formData.nome)}
                                        onChange={handleChange}
                                        placeholder="Gerado automaticamente"
                                    />

                                    <label htmlFor="estado_civil">Estado Civil:</label>
                                    <select id="estado_civil" name="estado_civil" value={formData.estado_civil || ''} onChange={handleChange}>
                                        <option value="">Selecione</option>
                                        <option value="Solteiro">Solteiro</option>
                                        <option value="Casado">Casado</option>
                                        <option value="Divorciado">Divorciado</option>
                                        <option value="Viúvo">Viúvo</option>
                                    </select>

                                    <label htmlFor="morador_rua">
                                        <input 
                                            type="checkbox" 
                                            id="morador_rua" 
                                            name="morador_rua" 
                                            checked={formData.morador_rua || false}
                                            onChange={handleChange}
                                        />
                                        Morador de Rua
                                    </label>
                                </div>
                            </div>

                            <label htmlFor="comentario">Observações:</label>
                            <textarea 
                                name="comentario" 
                                id="comentario" 
                                placeholder="Informações adicionais sobre o paciente" 
                                rows="4"
                                value={formData.comentario || ''}
                                onChange={handleChange}
                            />

                            <button type="submit" disabled={isSubmitting}>
                                {isSubmitting ? 'Cadastrando...' : 'Cadastrar Paciente'}
                            </button>
                        </form>
                    </section>
                </>
            );
        }

        // Layout
        function Layout({ children }) {
            return (
                <>
                    <div className="headerContent">
                        <header>
                            <h1>SOS Sorocaba</h1>
                            <h4>Sistema de Gestão Social</h4>
                        </header>
                    </div>
                    <div className="mainContent">
                        <main>{children}</main>
                    </div>
                    <div className="footerContent">
                        <footer>
                            <h3>SOS Sorocaba</h3>
                            <h4>Plataforma de Assistência Social</h4>
                        </footer>
                    </div>
                </>
            );
        }

        function App() {
            return (
                <Layout>
                    <Register />
                </Layout>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>